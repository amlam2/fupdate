# fupdate.js -- скрипт для автоматического обновления файлов на РМ

Запускается с помощью nnCron при поступлении архива обновлений в каталог входящей информации. Работает в закрытой локальной сети, не имеющей доступа в Internet.

1. Распаковывает во временный каталог Windows архив обновлений файлов, поступивших в каталог входящей информации. Архив передаётся скрипту как аргумент (например: "fbox.rar|zip|7z|arj"). Для распаковки используется
архиватор 7-zip: т. е. работы скрипта необходимо в каталог Windows скопировать следующие файлы:

- 7z.exe
- 7z.dll

2. Копирует файлы из архива на диск, заданный файлом-меткой в этом архиве с именем в вида "c|d|e|и т. д." Если такого файла нет, то по-умолчанию выбирается диск "d:".

3. Выполняет скрипты, помещённые в этот архив. Скрипты должны быть с расширением "bat|cmd|py|js|vbs". Выполняются перед или после копирования файлов архива в зависимости от имени файла скрипта (например: "0_.py" - перед, "_128.js" - после). Очерёдность выполнения каждого вида скриптов зависит от цифровой части имени файла скрипта, т. е. "0_.cmd" выполнится раньше, чем "1_.cmd". Для выполнения скриптов Python должен быть установлен интерпретатор.
